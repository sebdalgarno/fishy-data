[
  {
    "path": "posts/2021-04-21-scr-acoustic/",
    "title": "Spatial Capture-Recapture for acoustic telemetry",
    "description": "what is spatial capture-recapture and how can it be applied to acoustic telemetry data (especially from linear arrays)?",
    "author": [
      {
        "name": "Seb Dalgarno",
        "url": "https://github.com/sebdalgarno"
      }
    ],
    "date": "2021-04-21",
    "categories": [
      "Spatial Capture-Recapture",
      "Hidden Process Models",
      "Acoustic Telemetry",
      "Statistical Models",
      "Bayesian Stats"
    ],
    "contents": "\nNote, this post draws heavily from (Royle, Fuller, and Sutherland 2018)\nUnifying population and landscape ecology\nPopulation ecology is concerned with animal movement, demographic rates (e.g., growth rate, survival rate) and variation in population size/structure. It is traditionally not concerned with the effects of within-population spatial processes on populations.\nIn reality, population dynamics in space and time are driven by the structure of the landscape. Landscape ecology is concerned with linking ecological processes to landscape structure (e.g., landscape connectivity, resource selection functions). However, landscape ecology studies typically focus on individuals, without formally taking into account how individuals are sampled from a population and therefore without the ability to make inferences about the population.\nCapture-recapture (CR) methods have become the cornerstone of population ecology. They allow us to make inferences about populations when we are only able to observe a small fraction of individuals, at a limited number of locations and points in time. However, CR methods are disconnected from spatial structure, reducing sampled spatial encounter histories to sequences of observed/not observed, irrespective of which trap the individual was observed at. This eliminates the possibility to study important ecological questions such as within-population spatial structure (i.e., population density).\nSpatial capture-recapture (SCR) aims to rectify this shortcoming in CR methods and unify aspects of population and landscape ecology. With SCR, we can answer spatial ecological phenomena such as density, movement, landscape connectivity and resource selection. This allows us to â€˜downscaleâ€™ our understanding of population structure, i.e., at finer scales, rather than as broad-scale summaries.\nThe problem of density as motivating example\nDensity is a population state of interest in most animal monitoring studies. When we try to estimate population abundance or density from closed-population CR methods that are not spatially-explicit, we run into two major issues:\nIt is difficult to estimate density (population abundance/area) when we cannot precisely define the area that weâ€™ve sampled and when individuals can move in and out of the sample region.\nThe probability of sampling an individual varies by device and location (e.g., individuals at outer edge of sampling grid have lower probability of capture).\nA Spatial Capture-Recapture model\nTo address this we use a Spatial Capture-Recapture model, which is a heirarchical model consisting of spatial encounter history data, spatially explicit point process model, and an encounter probability model:\nspatial encounter history data - a 3-dimensional dataset with information on whether an individual was observed (or not) at specific trap locations in time (Figure 1).\nspatially explicit point process model - it assumed that each individual in a population has an activity center, which is expressed as 2-d coordinates (or 1-d coordinate along a line, e.g., a river) and the collection of activity centers is the realization of a spatial point process. The spatial point process is described by a distribution function which determines how individuals are distributed in space. For example, a simple spatial point process assumes that activity centers are distributed uniformly in space. More complex distribution functions may incorporate covariates (e.g., forest cover, stream network; Figure 2).\nencounter probability model - We can model encounter histories as bernoulli outcomes with probability of encountering an individual at each trap/time combination. The probability is a detection probability, which is a function of the Euclidean distance between the trap and an individualâ€™s latent activity center. Typically this function follows a half-normal distribution (Figure 3).\n\n\n\nFigure 1: Non-spatial encounter history data vs.Â spatial encounter history data (Royle, Fuller, and Sutherland 2018).\n\n\n\n\n\n\nFigure 2: Point process distribution of activity centers with covariates (Royle, Fuller, and Sutherland 2018).\n\n\n\n\n\n\nFigure 3: Half-normal encounter probability (Royle, Fuller, and Sutherland 2018).\n\n\n\nA SCR model therefore estimates three parameters:\np0 - probability of encountering an individual at itâ€™s activity center\nÏƒ - rate at which detection probabilit declines as a function of distance\nN or D - population size (N) or density (D)\nHow can SCR be applied to acoustic telemetry data?\nAcoustic telemetry data is similar to capture-recapture data collected from, e.g., terrestrial sampling devices like hair snares or traps. As such, methods developed in the terrestrial capture-recapture literature are typically more applicable to acoustic telemetry than, for example, methods developed for satelite telemetry (with knowledge of continuous movement in time). In both acoustic telemetry and terrestrial trapping, unique individuals are identified at stationary and continuously monitored traps (or acoustic receivers), providing a spatial encounter history for each individual.\nOne key difference in acoustic telemetry data is that information is only collected from tagged (sampled) individuals, limiting our ability to make inferences about the population (e.g.Â population size). However, these data can be supplemented with general capture-recapture data of both tagged and non-tagged individuals (e.g., from fishing) to make population-level inferences. Few examples of applications of SCR to acoustic telemetry exist to date. In general, acoustic telemetry technology appears to be advancing faster than the statistical methods required to analyze the data they produce. As a result, acoustic telemetry studies investigating spatial ecological phenomena typically resort to descriptive statistics, data summaries and data visualizations, which lack quantitative rigor (Raabe, Gardner, and Hightower 2014).\nOne typical use for acoustic telemetry data (especially for freshwater fisheries) is to estimate demographic parameters such as survival using more traditional CR methods. These demographic rates are very useful for management of freshwater fish populations, but fail to take advantage of the spatial information in spatial encounter histories. Using SCR methods, we can study spatial ecological phenomena like movement, habitat use, distribution and density.\nSome example studies\nRaabe, Gardner, and Hightower (2014)\nDorazio and Price (2019)\nThere are some examples of application of SCR methods to acoustic telemetry data in linear arrays (e.g., along a river represented by one-dimensional spatial location, river kilometer); notably, Raabe, Gardner, and Hightower (2014) and .\n\n\n\nDorazio, Robert M., and Melissa Price. 2019. â€œState-space models to infer movements and behavior of fish detected in a spatial array of acoustic receivers.â€ Canadian Journal of Fisheries and Aquatic Sciences 76 (4): 543â€“50. https://doi.org/10.1139/cjfas-2018-0067.\n\n\nRaabe, Joshua K., Beth Gardner, and Joseph E. Hightower. 2014. â€œA spatial captureâ€“recapture model to estimate fish survival and location from linear continuous monitoring arrays.â€ Canadian Journal of Fisheries and Aquatic Sciences 71 (1): 120â€“30. https://doi.org/10.1139/cjfas-2013-0198.\n\n\nRoyle, J. Andrew, Angela K. Fuller, and Christopher Sutherland. 2018. â€œUnifying population and landscape ecology with spatial captureâ€“recapture.â€ Ecography 41 (3): 444â€“56. https://doi.org/10.1111/ecog.03170.\n\n\n\n\n",
    "preview": "posts/2021-04-21-scr-acoustic/half-normal.png",
    "last_modified": "2021-04-22T13:51:33-07:00",
    "input_file": {},
    "preview_width": 1090,
    "preview_height": 588
  },
  {
    "path": "posts/2021-04-20-whoriskey-methods/",
    "title": "Statistical methods for acoustic telemetry data",
    "description": "A summary of Whoriskey et al. (2019) exploration of current and emerging statistical techniques for acoustic telemetry data.",
    "author": [
      {
        "name": "Seb Dalgarno",
        "url": "https://github.com/sebdalgarno"
      }
    ],
    "date": "2021-04-20",
    "categories": [
      "Acoustic Telemetry",
      "Stats"
    ],
    "contents": "\nItâ€™s a pretty exciting time to have telemetry data! Technology is advancing rapidly, the quantity and size of datasets is growing, and important questions are being answered that improve our understanding and management of aquatic species. However, statistical methods used to analyze these data are not keeping up with the pace of progress, as analyses are often descriptive and lacking quantitative rigor. (Whoriskey et al. 2019) outlines some of the current and emerging statistical methods to analyze telemetry data and improve this growing field.\nNote that the paper does not review methods for spatially continuous data (e.g., GPS data) and focuses on telemetry from fixed receiver station, a method that is gaining popularity for the study of aqautic animals. These data (referred to as â€˜detectionsâ€™) basically consist of unique ID of fish (transmitter), timestamp of detection, and receiver ID (which can be linked to a fixed location via receiver deployment information).\nWhich statistical method?\nThe choice of statistical method depends on the question of interest and the study design (e.g., spatiotemporal design of receiver deployment). The paper reviews 4 main methods: generalized modelling framework, survival analysis, capture-recapture models, and network analysis. Depending on the method, raw detection data will have to be summarized in some way to create the appropriate response variable (e.g., total detections/receiver/time period, residence, movement rate). Generation of these metrics (as well as generation of descriptive statistics and data visualizations) is faciliated by the actel R package.\nGeneralized modelling framework\nGeneralized modelling framework includes Generalized Linear Models (GLM), Generalized Additive Model (GAM) and Generalized Linear Mixed Models (GLMM). All of these are regression models (at increasing levels of complexity) that can be used to relate some response variable y to a set of putative explanatory covariates.\nWith a GLM, we can model response variables that are not Gaussian-distributed (e.g., Poisson, Binomial) to a set of categorical or continuous covariates and a monotonic link function. Since detection data often have a large number of absences (i.e., no detection at receiver in given time period), zero-inflated models may be appropriate.\nGAMs are useful when there is a nonlinear relationship between the response and covariates as they use smoothing functions. GLMMs are useful when it is necessary to account for variation within and among sampling units (i.e., random effects). For example, if individual ID is modelled as a random effect each unique individual could have a different intercept and/or slope. Random effects could also account for spatial/temporal dependence (i.e.Â sampling location or year)\nSurvival analysis\nWith survival analysis, we are interested in estimating the time it takes for an event to happen. This could be death, but also migration events, passing through obstacles, interacting with humans, and more. this is done by extending the response of a binomial GLM (event happened vs event didnâ€™t happen) with a survival function that determines the probability of an event happening at some time. Kaplan-Meier and Nelson-Aalen are common survival function estimators.\nMark-recapture models\nWith mark-recapture, we capture and recapture individuals to generate an encounter history sequence, which is useful for estimating movement or population demographic parameters like survival or abundance. In acoustic telemetry, each detection event can be considered a recapture event. an important distinction to make in comparison to conventional mark-recapture data is that only tagged animals are monitored. Known-fate (no detection probability), live-recapture (detection probability), and recovery (recapture is terminal) models are useful for these types of data.\nThe Cormack Jolly-Seber (CJS) model is a useful live-recapture model for estimating apparent survival. Apparent is a necessary caveat here as it cannot be known whether a fish died or emigrated. A CJS model estimates two parameters: Ï†, the probability that a fish survived and p, the probability that a fish was detected if alive and marked. The multiâ€state Arnasonâ€“Schwarz model is an extension to CJS allowing where survival and detection probability vary according to an observed state (see also Hidden Markov Models).\nNetwork analsyis\nNetworks consist of nodes and edges, where node degree (number of incoming/outgoing edges) and edge density (number of edges/total possible edges) are metrics calculated from the data. Movement can be studied when receivers are represented by nodes and movement between receivers as edges. In this case, node degree represents total receiver traffic and may indicate an important or highly used area. If unique fish are treated as nodes, we can study social aggregation (i.e., preferred associations between fish).\nNetworks are very useful for visualization, where for example node degree can be visualized as circle size and edge density as line width. Nodes can be shown on a map in their actual location (Figure 1) or as a plot untethered from the real world location. Hypotheses can also be tested using GLMMs (i.e., with network matrix as response variable) or with non-parametric methods (e.g., to compare a network with a randomly generated network).\n\n\n\nFigure 1: Example of network analysis output (Whoriskey et al. 2019).\n\n\n\nFuture directions\n(Whoriskey et al. 2019) offers some interesting emerging methods:\nGaussian Random Fields may be useful for understanding spatial context by estimating residual spatial correlation from remaining variation after explanatory covariates are considered. For example in figure 2 we can see in panel D the expected number of fish after the effect of other model covariates (distance from dam; panel c) are taken into account.\nSpatial Capture-Recapture (SCR) is an exciting extension to mark-recapture methods that fully taking advantage of the spatial component of individual encounter histories by modeling latent activity centers as a spatial point process. Although SCR has been used fairly extensively in terrestrial studies but not yet in aquatic studies with acoustic telemetry data.\nState-Space Models (and Hidden Markov Models) are heirarchical models that estimate both the state process (e.g., model for animal movement) and the observation (or measurement) process together. These could provide a useful and general framework for analysis of detection data and are already being used in studies of continuous animal movement data fairly frequently.\ngeneral improvement and uptake of methods for handling spatial autocorrelation\ngeneral improvement and uptake of methods for dealing with measurement error (e.g., variation in detection of range of receivers), which can either be used to preprocess data or directly incorporated into model structure.\n\n\n\nFigure 2: Example of Gaussian Random Fields analysis (Whoriskey et al. 2019).\n\n\n\nSo which method to choose? (Whoriskey et al. 2019) provides a handy tree diagram to help (Figure 3). In summary: use mark-recapture methods for population dynamics; survival analysis to estimate time to an event (e.g., survival where the response variable is a unit of time rather than presence/absence); network analysis to describe connectivity between receivers or individual fish; GRFs to investigae spatial correlation; and a generalized modeling framework (GLM/GAM/GLMM/GAMM) for basically any other purpose when relating a response variable to some set of putative explanatory covariates.\n\n\n\nFigure 3: Decision tree for selecting a statistical method to analyze telemetry detection data (Whoriskey et al. 2019).\n\n\n\n\n\n\nWhoriskey, Kim, Eduardo G. Martins, Marie Augerâ€MÃ©thÃ©, Lee F. G. Gutowsky, Robert J. Lennox, Steven J. Cooke, Michael Power, and Joanna Mills Flemming. 2019. â€œCurrent and emerging statistical techniques for aquatic telemetry data: A guide to analysing spatially discrete animal detections.â€ Methods in Ecology and Evolution 10 (7): 935â€“48. https://doi.org/10.1111/2041-210x.13188.\n\n\n\n\n",
    "preview": "posts/2021-04-20-whoriskey-methods/network.png",
    "last_modified": "2021-04-23T11:57:37-07:00",
    "input_file": {},
    "preview_width": 1120,
    "preview_height": 590
  },
  {
    "path": "posts/2021-04-16-its-a-hidden-process-model/",
    "title": "It's a hidden process model",
    "description": "Is it possible for a model to be categorized as a Hidden Markov Model, State-Space Model, and Spatial Capture-Recapture model, all at the same time?",
    "author": [
      {
        "name": "Seb Dalgarno",
        "url": "https://github.com/sebdalgarno"
      }
    ],
    "date": "2021-04-16",
    "categories": [
      "State-Space Models",
      "Spatial Capture-Recapture",
      "Statistical Models"
    ],
    "contents": "\nWhich model is it?\nIâ€™ll be honest, I was initially confused as I read Dorazio and Price (2019) as to what kind of modelling approach was being used.\nReading the title\n\nâ€œState-space models to infer movements and behavior of fish detected in a spatial array of acoustic receiversâ€\n\nit is clear State-Space models (SSM) are used.\nReading a section of the abstract\n\nâ€œIn these models, fish movements and behavior switching are specified using a hidden Markov model of the changes in an individualâ€™s latent activity centerâ€\n\nit is clear that a Hidden Markov Model (HMM) is used, and reference to â€œan individualâ€™s latent activity centerâ€ leads me to think that this is a Spatial Capture-Recapture (SCR) model, although the term â€œspatial capture-recaptureâ€ is not present in the paper.\nSo what is going on here? Is it all of these things?\nThis may already be clear to you, but the answer is yes, it is all of these things.\nHidden process models\nAccording to King (2013), many ecological models have developed independently, leading to different terminology. A group of these models (termed hidden process models) all couple a system process describing the underlying hidden biological process of interest (e.g., behavioural state, spatial location) with an observation process (i.e., the actua data measured). The observed data are conditionally independent given the underlying states. Since multiple models are combined, these can broadly be classified as heirarchical or generalized linear mixed models (Whoriskey et al. 2019).\n\n\n\nFigure 1: A graphical representation of a hidden Markov model (HMM) or state-space model (SSM) where Y1 , Y2 , . . . , YT denote the underlying system process and X1,X2,â€¦,XT denote the corresponding observation process (King 2013).\n\n\n\nHMM + SSM\nHMM and SSMs are both hidden process models that are very closely related. Kim Whoriskey provides further clarity in her PhD thesis, with reference to Auger-MÃ©thÃ© et al. (2020):\n\nâ€œDespite their separate developmental histories, HMMs and SSMs are both hierarchical models wherein the observations are dependent upon a set of unobserved variables - random effects, or states - that follow a Markov process, and the literature appears to have converged around the viewpoint that HMMs are special cases of SSMs with discrete latent statesâ€\n\nWe can therefore make the following distinction:\nHMM - unobserved random effects (latent states) are discrete\nSSM - unobserved random effects (latent states) are continuous\nIn animal movement studies, SSMs are generally used to predict spatial location, whereas HMMs are used to predict discrete behavioural states. Switching models can be used to predict location and behaviour simultaneously, thus enabling us to account for location error (if it exists) and estimate behavioural state from the corrected locations (Jonsen et al. 2013). This is better than simply using predicted location as a response variable in a second model (HMM) because it is able to include the uncertainty in location prediction in estimates of behavioural state.\nWhere does SCR fit in?\nSCR methods are catered toward a specific kind of ecological data - spatial encounter histories of individuals - which are generated from trapping grids or similar sampling technologies (e.g., acoustic telemetry arrays). In â€˜typicalâ€™ SCR studies to date, an individualâ€™s activity center (i.e., expected location) is assumed to be static throughout the study period. We can modify this model to investigate movement or dispersal by coupling a latent movement model (e.g., simple Markovian movement model or correlated random walk) with the spatial encounter model to look at change in activity center over time. In this formulation, the SCR model is characterized as a SSM or HMM.\nBringing it home\nComing back to Dorazio and Price (2019), we can say that this is a SCR movement model (i.e., it is estimating shift in activity centers over time) that couples a latent movement model (correlated random walk) with the spatial encounter model. It is also an HMM, which we now know is a special case of an SSM with a discrete latent variable (resident vs transient behavioural state). Even more broadly, it is a hidden process model. Theyâ€™re all hidden process models!\n\n\n\nAuger-MÃ©thÃ©, Marie, Ken Newman, Diana Cole, Fanny Empacher, Rowenna Gryba, Aaron A King, Vianney Leos-Barajas, et al. 2020. â€œA guide to state-space modeling of ecological time series.â€ arXiv.\n\n\nDorazio, Robert M., and Melissa Price. 2019. â€œState-space models to infer movements and behavior of fish detected in a spatial array of acoustic receivers.â€ Canadian Journal of Fisheries and Aquatic Sciences 76 (4): 543â€“50. https://doi.org/10.1139/cjfas-2018-0067.\n\n\nJonsen, I. D., M. Basson, S. Bestley, M. V. Bravington, T. A. Patterson, M. W. Pedersen, R. Thomson, U. H. Thygesen, and S. J. Wotherspoon. 2013. â€œState-space models for bio-loggers: A methodological road map.â€ Deep Sea Research Part II: Topical Studies in Oceanography 88: 34â€“46. https://doi.org/10.1016/j.dsr2.2012.07.008.\n\n\nKing, Ruth. 2013. â€œStatistical Ecology.â€ Annual Review of Statistics and Its Application 1 (1): 401â€“26. https://doi.org/10.1146/annurev-statistics-022513-115633.\n\n\nWhoriskey, Kim, Eduardo G. Martins, Marie Augerâ€MÃ©thÃ©, Lee F. G. Gutowsky, Robert J. Lennox, Steven J. Cooke, Michael Power, and Joanna Mills Flemming. 2019. â€œCurrent and emerging statistical techniques for aquatic telemetry data: A guide to analysing spatially discrete animal detections.â€ Methods in Ecology and Evolution 10 (7): 935â€“48. https://doi.org/10.1111/2041-210x.13188.\n\n\n\n\n",
    "preview": "posts/2021-04-16-its-a-hidden-process-model/hidden-process.png",
    "last_modified": "2021-04-22T11:32:19-07:00",
    "input_file": {},
    "preview_width": 1172,
    "preview_height": 390
  },
  {
    "path": "posts/2021-04-14-movement-ecology/",
    "title": "Nathan's movement ecology paradigm",
    "description": "A reflection on how Nathan's movement ecology paradigm might apply to the study of fish movement from acoustic telemetry data.",
    "author": [
      {
        "name": "Seb Dalgarno",
        "url": "https://github.com/sebdalgarno"
      }
    ],
    "date": "2021-04-15",
    "categories": [
      "Movement Ecology",
      "Acoustic Telemetry"
    ],
    "contents": "\nThe study of animal movement has advanced a lot in recent years. Nathan et al. (2008) suggests that advancements in animal tracking technology, environmental monitoring, and analytical methods (i.e.Â from increased computational power) have led to a general shift from the study of population redistribution (Eularian approach) to the study of individuals (Lagrangian approach). This has enabled development of more complex models (e.g.Â state-space models for individual animal movement) and increased understanding of movement ecology. However, a common framework is necessary to unify several paradigms for animal movement (i.e.Â biomechanical, cognitive, random, optimality) that are operating parallel to one another.\nIn this attempt to unify the study of animal movement, Nathan et al. (2008) suggests that there are four overarching questions:\nWhy do animals move?\nHow do animals move?\nWhen and where do animals move?\nWhat are the external factors driving animal movement?\nFollowing from this, it is suggested that animal movement is a function of internal state (why), motion capacity (how), navigation capacity (when and where) and external factors (abiotic and biotic). In this formulation, the motion process and navigation process are both impacted by current location, internal state (i.e.Â physiological or neurological state affecting motivation and readiness to move) and external factors. The movement propagation process is the realized movement resulting from the motion process, which is optionally affected by the navigation process.\n\n\n\nFigure 1: Framework for animal movement (Nathan et al. 2008)\n\n\n\nThe result of this process is a lifetime movement track, which (at least partially) is observed by us. This track can be parsed into sub-units at various spatial and temporal scales. At a finer scale, movement paths can represent particular phenomena such as feeding or migrating. At even finer scales, movement steps might correspond to a few steps and a stop. Our ability to successfully identify movement phases depends on our ability to sample an individualâ€™s movement (i.e.Â sampling frequency, duration and protocol).\nSpatiotemporal scales of sanimal movement (Nathan et al. 2008)A major challenge in the study of fish movement from acoustic telemetry is that sampling frequency and duration is often limited. Movement tracks from stationary receivers typically have frequent and potentially large gaps in observed fish position in space and time. These gaps can occur when a fish is moving or resting between receivers, has died or emigrated outside of the receiver array, or has not been detected despite actually being present due to detection error. Note, however, that it is possible in some small study areas (e.g.Â small lake) to set up an acoustic telemetry array capable of collecting fine scale position data, allowing us to reconstruct a continuous track of an individualâ€™s movement (more akin to satelite temetry data).\nSpecialized statistical methods such as state-space models are required to uncover the ecological process of interest (e.g.Â spatial position) from typically noisy observation data. Hidden Markov Models are a class of state-space models useful for uncovering a finite number of states of interest (e.g., behavioral states such as resident vs transitory), which could correspond to â€˜movement pathsâ€™ (McClintock et al. 2020). Spatial capture-recapture models also have great potential for estimating distribution/density over time (i.e.Â as an animalâ€™s activity center, or collection of activity centers), taking into account detection error (Royle, Fuller, and Sutherland 2018).\nIn acoustic telemetry studies we are typically interested landscape or population ecology questions (e.g.Â distribution, density, survival), which typically involve relating the internal state (e.g., motivations for moving such as feeding, spawning) to external factors (e.g., water temperature, discharge). Nathan places this type of research in the â€˜optimalityâ€™ paradigm.\nHowever, the utility of the framework proposed in Nathan et al. (2008) is to force us to more comprehensively think about different drivers of fish movement in our models. In order to interpret our results, inform our study design, or place constraints on our model predictions, we need to consider motion capacity and navigation capacity of the animal being studied. This information can be drawn from biomechanical and cognitive paradigms of animal movement research. For example, understanding of motion capacity might inform us whether a fish is incapable of swimming in certain conditions (e.g., high flow, extreme water temperature). Understanding of navigation capacity might inform our understanding of what time of year a fish is going to migrate. One technology with great potential for improving our understanding the motion process are Data Storage Tags, which can measure physiological information as a fish moves (heart rate, muscle activity, acceleration) along with environmental conditions (e.g., water temperature).\nThrough advancements in technology (e.g., tracking technology, collection of physiological/environmental data), statistical methods (e.g., state-space models spatial capture-recapture), and incorporating our understanding of navigation and motion capacity of fish, there is great potential for this framework to improve the study of fish movement from acoustic telemetry data.\n\n\n\nMcClintock, Brett T., Roland Langrock, Olivier Gimenez, Emmanuelle Cam, David L. Borchers, Richard Glennie, and Toby A. Patterson. 2020. â€œUncovering ecological state dynamics with hidden Markov models.â€ Ecology Letters 23 (12): 1878â€“1903. https://doi.org/10.1111/ele.13610.\n\n\nNathan, R, W M Getz, E Revilla, M Holyoak, R Kadmon, D Saltz, and P E Smouse. 2008. â€œA movement ecology paradigm for unifying organismal movement research.â€ Proceedings of the National Academy of Sciences 105 (49): 19052â€“59. https://doi.org/10.1073/pnas.0800375105.\n\n\nRoyle, J. Andrew, Angela K. Fuller, and Christopher Sutherland. 2018. â€œUnifying population and landscape ecology with spatial captureâ€“recapture.â€ Ecography 41 (3): 444â€“56. https://doi.org/10.1111/ecog.03170.\n\n\n\n\n",
    "preview": "posts/2021-04-14-movement-ecology/process.png",
    "last_modified": "2021-04-20T17:37:16-07:00",
    "input_file": {},
    "preview_width": 886,
    "preview_height": 810
  },
  {
    "path": "posts/2021-04-15-hmm/",
    "title": "Hidden Markov Models for fish ecology",
    "description": "What are HMMs, how are they used in ecology and how can they improve our understanding of fish movement and behaviour?",
    "author": [
      {
        "name": "Seb Dalgarno",
        "url": "https://github.com/sebdalgarno"
      }
    ],
    "date": "2021-04-15",
    "categories": [
      "Stats",
      "Movement Ecology",
      "Hidden Markov Model",
      "Acoustic Telemetry"
    ],
    "contents": "\nA big picture look at Hidden Markov Models\nHidden Markov Models (HMM) can be used for ecological time series data to uncover hidden ecological states (McClintock et al. 2020). They are gaining popularity in ecology, where they have been frequently used to model capture-recapture data (e.g., for survival rate estimation via Cormack Jolly-Seber model) and animal movement data to investigate behavioural states in animals that exhibit distinct beavioral modes (e.g., resident vs transient)(Auger-MÃ©thÃ© et al. 2020).\nBroadly speaking, HMMs are heirarchical models. Slightly more specifically, HMMs can be classified as Hidden Process models, where a model for the state process (i.e., the hidden ecological state of interest) is coupled with a model for the observation process (King 2013). Even more specifically, HMMs are a special case of state-space model (SSM) with a discrete and finite number of states in the process model. In these models, the state process is not directly observed; rather it is a hidden (or latent) variable. The observations (e.g., from telemetry or capture-recapture), which make up the observation model, are generated by the underlying state process but are â€˜noisyâ€™ measurements that are insufficient when considered alone to determine the state.\nThese models can be complex and are most sensibly used when one would expect high variance in the process and high observation error. However, (Auger-MÃ©thÃ© et al. 2020) argues that SSMs (and HMMs by extension) should be the default statistical modeling technique for all ecological time series data.\nTell me moreâ€¦\nHMMs have two main characteristics:\nEach observation is assumed to be generated by the distribution of one of a set of possible states. The state assigned to the observation at time t is directly dependent on the state at time t and is independent of the states or observations at any other times (known as conditional independence).\nThe sequence of states is modeled as a Markov chain, where the probability of being in a state at time t is directly determined by the state at time t - 1.\nAn HMM is specified with three major componenets:\nintitial distribution - a vector of probabilities for each state at the start of the time sequence.\nstate transition probabilities - a matrix of probabilities for switching from any state at time t to another state at time t + 1.\nstate-dependent distribution - probability distribution of an observation conditional on the state at time t. This depends on the form of the observed data, e.g.Â count data are poisson distributed, positive continous data may be gamm distributed, etc.\nA model can be fit using Maximum Likelihood or Bayesian methods.\nApplication of HMM to fish movement\n(McClintock et al. 2020) provides a number of examples for application of HMMs to the existential, developmental and spatial states of animals at the level of individual, population, or community. Here are a few examples that could be useful for understanding fish movement/behaviour at the individual level from capture-recapture and acoustic telemetry data.\nSurvival\nWe can estimate surival (an existential question) using the Cormack-Jolly Seber model, with 2 states (alive and dead).\n\n\n\nFigure 1: Specification for a survival HMM (McClintock et al. 2020)\n\n\n\nThe transition probability matrix is rather simple in this case (Figure 2): probability of staying dead is 1; the probability of coming back to life once dead is 0; the probability of dying is the probability of not surviving (1 - survival rate); and the probability of surviving is equal to the survival rate.\n\n\n\nFigure 2: Transition probability matrix for CJS HMM survival model (Auger-MÃ©thÃ© et al. 2020)\n\n\n\nBehavioural mode\nIn order to investigate whether a fish is in one of several possible behavioural modes, we can extend the survival HMM above to include multiple states (e.g., â€˜alive and breeding,â€™ â€˜alive and non-breeding,â€™ â€˜deadâ€™). This could help us to identify, for example, migratory phases, predation/feeding events, or hibernation/overwintering cycles.\nIn multi-state models of animal movement, observations are typically expressed as a bivariate sequence of step-length (Euclidean distance) and turning angle. A hypothetical two-state model might consist of â€˜residentâ€™ and â€˜transientâ€™ states, where movements in the â€˜transientâ€™ state have longer step-lengths and more persistent turning angles and movements in the â€˜residentâ€™ state have smaller step-lengths with frequent changes in turning angle. Step-length is typically modeled with a gamma or Weibull probability distribution and turning angle is typically modeled with a von Mises or wrapped Cauchy distribution.\nThe number of states to select may not be clear a priori and can be selected based on biological understanding and possibly, via model selection. The state transition probabilities are also not predetermined, but are freely estimated by the model.\nSpecification for a multi-state behaviour HMM with bivariate observation process (McClintock et al. 2020)Spatial location\nWe can predict movement to or from specific spatial locations, where each state corresponds to a site (e.g.Â spawning vs overwintering site). This follows the same model specification as the above behaviour example, but the observations are univariate site locations (e.g.Â A, B, and 0, where A and B might correspond to a spawning site and overwintering site, respectively, and 0 is unknown location). State transition probabilities in this case are interpreted as probability of fidelity/dispersal. In this case, we could use the model to predict specific location at times in the observation sequence where location is unknown. Note, a state-space model or spatial capture-recapture model may be more appropriate in this case for estimation of location or activity center in conitnuou spaceK.\nSpecification for a spatial HMM where observations correspond to a site (McClintock et al. 2020)\n\n\nAuger-MÃ©thÃ©, Marie, Ken Newman, Diana Cole, Fanny Empacher, Rowenna Gryba, Aaron A King, Vianney Leos-Barajas, et al. 2020. â€œA guide to state-space modeling of ecological time series.â€ arXiv.\n\n\nKing, Ruth. 2013. â€œStatistical Ecology.â€ Annual Review of Statistics and Its Application 1 (1): 401â€“26. https://doi.org/10.1146/annurev-statistics-022513-115633.\n\n\nMcClintock, Brett T., Roland Langrock, Olivier Gimenez, Emmanuelle Cam, David L. Borchers, Richard Glennie, and Toby A. Patterson. 2020. â€œUncovering ecological state dynamics with hidden Markov models.â€ Ecology Letters 23 (12): 1878â€“1903. https://doi.org/10.1111/ele.13610.\n\n\n\n\n",
    "preview": "posts/2021-04-15-hmm/survival-hmm.png",
    "last_modified": "2021-04-22T21:11:23-07:00",
    "input_file": {},
    "preview_width": 1308,
    "preview_height": 308
  },
  {
    "path": "posts/2021-04-14-alfred/",
    "title": "Alfred + .Rproj",
    "description": "How to configure Alfred to search for .Rproj files",
    "author": [
      {
        "name": "Seb Dalgarno",
        "url": "https://github.com/sebdalgarno"
      }
    ],
    "date": "2021-04-14",
    "categories": [
      "Productivity",
      "RStudio"
    ],
    "contents": "\nTL;DR add dyn.ah62d4rv4ge81e6dwr7za to Preferences -> Features -> Default Results -> Advanced... panel to add .Rproj as a user-defined file type.\nOverview\nAlfred app is a productivity app (in their words) for MacOS 1 that does many many things. So far, Iâ€™ve just been using itâ€™s search functionality and am finding it quite sweet indeed (think Spotlight, but better). The use case here is that I want to avoid using my mouse to search for various Rstudio .Rproj files (i.e.Â in Finder).\nHadley is god\nI first came across this tip from Hadley Wickham in this video - so you know itâ€™s good.\nInstalling Alfred\nInstall Alfred from the website or with homebrew on the command line:\nbrew install --cask alfred\nConfiguring Alfred for .Rproj\nOpen Alfred and get into Preferences -> Features -> Default Results panel.\nAlfred1Click on Advanced... and add the following user-defined file type (by clicking +)\ndyn.ah62d4rv4ge81e6dwr7za\nAlfred1Keyboard shortcut\nI like to open Alfred with the keyboard shortcut Cmd-space instead of Spotlight. I followed the instructions here to do this.\nDone! Now open Alfred with Cmd-space and start typing in the name of a .Rproj file. Note you can add other file types for Alfred to look for (e.g.Â Scrivener projects). A final tip is that if you press space before typing the file name, Alfred will search all files.\nIf you are looking for more Mac productivity tips, check out this awesome Twitter thread\n\nSorry Windows users. But there are other apps for Windows that do similar things.â†©ï¸Ž\n",
    "preview": {},
    "last_modified": "2021-04-14T21:49:45-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-04-14-git-alias/",
    "title": "Git alias tricks",
    "description": "Using a git alias to commit and stage all files and other fancy tricks.",
    "author": [
      {
        "name": "Seb Dalgarno",
        "url": "https://github.com/sebdalgarno"
      }
    ],
    "date": "2021-04-14",
    "categories": [
      "Productivity",
      "RStudio"
    ],
    "contents": "\nTL;DR type git config --global alias.coa \"!git add -A && git commit -m\" in the command line. From now on, use git coa 'message here' to commit and stage all files!\nOverview\nFor years I have staged, committed and pushed changes with the RStudio Git interface.\n\nIt works! But Iâ€™ve realized that itâ€™s much more efficient (and not hard!) to do from the command line. Check out this sweet resource by Jenny Bryan for more info on git with r.\nGit from the command line\nThis solution on stackoverflow suggests staging, committing and pushing all files by running the following in the command line:\ngit add -A && git commit -m \"rebuild site\"\ngit push\n\nGit alias\nReal productivity gains are made by using git aliases, which remove the need to type (and remember) full git commands. Letâ€™s start with a simple example. To set up the alias git p for git push, we run in the command line:\ngit config --global alias.p \"push\"\nGoing back to our original use case, we can set up the alias git coa:\ngit config --global alias.coa \"!git add -A && git commit -m\"\nFrom now on, we can stage, commit and push all changes with two simple commands:\ngit coa 'rebuild site'\ngit p\nHere are some more useful aliases:\nCreate and checkout branch\ngit config --global alias.bc \"checkout -b\"\ngit bc some_new_branch\nDelete branch locally and remotely (from here)\ngit config --global alias.bd '!sh -c \"git branch -D $1 && git push origin :$1\" -'\n\ngit bd some_new_branch\nKeyboard shortcut to Terminal\nTo completely remove the need to use the mouse, Iâ€™ve set up a customized keyboard shortcut1 Cmd-3 to move the cursor to the RStudio Terminal. Check out this great tutorial on customizing keyboard shortcuts in RStudio. The advantage of using the RStudio terminal and not the MacOS Terminal app (or iterm2)2 is that it is automatically drilled down into the directory of your project.\nðŸŽ‰ðŸŽ‰ðŸŽ‰\n\nI also use Cmd-1 to move cursor to script and Cmd-2 to move cursor to console.â†©ï¸Ž\nThese tips are for Mac users. Iâ€™m not sure how to do the above in Windows.â†©ï¸Ž\n",
    "preview": {},
    "last_modified": "2021-04-14T22:41:11-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-04-14-github-cli/",
    "title": "GitHub from the command line",
    "description": "Some tips and tricks for interacting with GitHub from the command line.",
    "author": [
      {
        "name": "Seb Dalgarno",
        "url": "https://github.com/sebdalgarno"
      }
    ],
    "date": "2021-04-14",
    "categories": [
      "Productivity",
      "GitHub"
    ],
    "contents": "\nOverview\nNavigating around the GitHub website between various repos/issues etc. is most definitely a time waster. Iâ€™ve decided to dig into the GitHub CLI. You can install it using homebrew with brew install gh and authorize it by running gh auth login in the command line (more info in this manual). Hereâ€™s a few things I found useful.\nDealing with issues\nList issues\nOnce you are drilled down into the project directory in the command line (or simply go to Terminal in an RStudio project), type the following:\ngh issue list\n\n# Showing 3 of 3 open issues in sebdalgarno/blog\n# \n# #6  add shortcodes                     about 1 day ago\n# #5  get RSS button working             about 1 day ago\n# #2  not rendering Rmd                  about 2 days ago\nView issues\nAs Iâ€™m writing this I realize that Iâ€™ve already solved #2. Iâ€™ll view it just to make sure.\ngh issue view 2\n\n# not rendering Rmd\n# Open â€¢ sebdalgarno opened about 2 days ago â€¢ 0 comments\n# \n# \n#   blogdown problem as other themes also not working                           \n# \n# \n# View this issue on GitHub: https://github.com/sebdalgarno/blog/issues/2\nClose issues\nYes! this was solved by moving to hugodown. Iâ€™ll close it.\ngh issue close 2\n# âœ” Closed issue #2 (not rendering Rmd)\nAs an aside, I use this neat little trick to close issues automatically by adding fixes #33 to a commit message (where 33 is the issue #). gh issue list is going to be super helpful to find the issue #.\nCreate issues\nIâ€™ll create an issue to finish this post. I am being a little hard on myself here (since Iâ€™m already working on it!), but I really should finish this post.\ngh issue create --title \"Finish GitHub CLI post\" --body \"Seriously, do it.\"\n\n# Creating issue in sebdalgarno/blog\n# \n# https://github.com/sebdalgarno/blog/issues/9\nand confirm:\ngh issue list\n\n# Showing 3 of 3 open issues in sebdalgarno/blog\n#\n# #9  Finish GitHub CLI post             about 1 minute ago\n# #6  add shortcodes                     about 1 day ago\n# #5  get RSS button working             about 1 day ago\nDealing with pull requests\nCreate changes on a branch\nIâ€™m going to create a branch called â€˜fix_that_bugâ€™ and fix that bug (you know, that one). Then Iâ€™ll commit and push those changes.\ngit cb fix_that_bug\n# Switched to a new branch \"fix_that_bug\"\n\ngit coa 'fixed it'\n[fix_that_bug 35457d9] fixed it\n 1 file changed, 3 insertions(+), 1 deletion(-)\n \ngit p\n{{% admonition tip tip %}} If the above git commands look strange thatâ€™s because theyâ€™re aliases! Check out my post on git alias for details. {{% /admonition %}}\nCreate pull request and merge\nNow Iâ€™ll create a pull request with gh,\ngh pr create --title \"fixed it\" --body \"good lord that took me 35 hours\" \n\n# ? Where should we push the 'fix_that_bug' branch? sebdalgarno/blog\n#\n# Creating pull request for fix_that_bug into master in sebdalgarno/blog\n#\n# remote: \n# remote: \n# To github.com:sebdalgarno/blog.git\n#  * [new branch]      HEAD -> fix_that_bug\n# Branch 'fix_that_bug' set up to track remote branch 'fix_that_bug' from 'origin'.\n# https://github.com/sebdalgarno/blog/pull/12\ncheck the diff (Ctrl-c to quit process)\ngh pr diff 12\nmerge it,\ngh pr merge 12\n# ? What merge method would you like to use? Create a merge commit\n# ? Delete the branch locally and on GitHub? Yes\n# ? Submit? Yes\n# âœ” Merged pull request #12 (fixed it)\n# âœ” Deleted branch fix_that_bug and switched to branch master\nand pull into local master (or main) branch.\ngit pull\nThatâ€™s it for now!\nOh ya one more thing\ngh issue close 9\n# âœ” Closed issue #9 (Finish GitHub CLI post)\n{{% admonition tip tip %}} See the full list of commands and examples and some resources for setting up scripts and aliases. {{% /admonition %}}\n\n\n\n",
    "preview": {},
    "last_modified": "2021-04-14T22:44:21-07:00",
    "input_file": {}
  }
]
